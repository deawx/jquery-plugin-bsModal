/*!
 * bsModal.js v1.0.1
 * https://github.com/yangchenshin77/bsModal
 *
 * Copyright 2018 Chen-shin, Yang
 * Released under the MIT license
 *
 * Date: 2018-11-05T04:58:40.434Z
 */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=function(o,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(o)),e(t),t}:e(jQuery)}(function(m){var o=m.fn.tooltip.Constructor.VERSION;if(Number(o.substr(0,1))<4)throw"Bootstrap version is not 4";function a(o){var t=void 0;t=0<=o.split(",")[0].indexOf("base64")?atob(o.split(",")[1]):unescape(o.split(",")[1]);for(var e=o.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return new Blob([n],{type:e})}m.fn.bsModal=function(o){var t=this,e={id:"exampleModal",title:"Modal title",titleLavel:5,body:"",label:null,lang:null,modal:null,fade:!0,close:!0,backdrop:!0,confirm:!1,okBtnText:"",cancelBtnText:"",confirmOkText:"",confirmCancelText:"",langs:{},okBtnColor:"primary",cancelBtnColor:"secondary",onOpen:function(){return!0},onClose:function(){return!0},onOk:function(){return!0},onCancel:function(){return!0}},n=m.extend({en:{okBtnText:"Save",cancelBtnText:"Close",confirmOkText:"OK",confirmCancelText:"Cancel"},"zh-TW":{okBtnText:"儲存",cancelBtnText:"關閉",confirmOkText:"確定",confirmCancelText:"取消"}},e.langs),a=n[e.lang]||n[navigator.language||navigator.userLanguage]||n.en;for(var r in a)e[r]=a[r];var i=m.extend({},e,o);i.label=i.label||i.id+"Label",i.confirm&&(i.okBtnText=i.confirmOkText,i.cancelBtnText=i.confirmCancelText,void 0===o.close&&(i.close=!1),void 0===o.backdrop&&(i.backdrop="static"));var l=null;if("string"==typeof i.modal&&(l=m(i.modal)),null===l){l=m('<div class="modal" />').addClass(i.fade?"fade":"").attr({id:i.id,tabindex:"-1",role:"dialog","aria-labelledby":i.label,"data-backdrop":i.backdrop}).appendTo("body");var d=m('<div class="modal-dialog" />').attr({role:"document"}).appendTo(l),c=m('<div class="modal-content" />').appendTo(d),p=m('<div class="modal-header" />').appendTo(c);m("<h"+i.titleLavel+' class="modal-title" />').attr("id",i.label).html(i.title).appendTo(p),i.body&&m('<div class="modal-body" />').html(i.body).appendTo(c);var s=m('<div class="modal-footer" />').appendTo(c);i.close&&m('<button class="close" type="button" data-dismiss="modal" aria-label="Close" />').append(m('<span aria-hidden="true">&times;</span>')).appendTo(p);var f=m('<button type="button" data-dismiss="modal" />').addClass("btn btn-"+i.cancelBtnColor).text(i.cancelBtnText).appendTo(s),u=m('<button type="button" />').addClass("btn btn-"+i.okBtnColor).text(i.okBtnText).appendTo(s);l.on("shown.bs.modal",function(){i.onOpen.call(t)}),l.on("hidden.bs.modal",function(){i.onClose.call(t)}),u.on("click",function(){!1!==i.onOk.call(t)&&l.modal("hide")}),f.on("click",function(){i.onCancel.call(t)})}return this.modal=l,this.attr({"data-toggle":"modal","data-target":"#"+l.attr("id")}),this},m.fn.bsModalCropper=function(o){var i=this;if("undefined"==typeof Cropper)throw"Error: Cropper.js is not found.";var t={id:"exampleModalCropper",confirm:!0,src:null,imgId:"exampleImage",cropper:{viewMode:1},action:null,method:"post",fileName:"file",data:{},uploadConfig:{allowTypes:["image/jpeg","image/png"],maxSize:5*Math.pow(1024,2)},success:function(){},error:function(){},axios:null,axiosOriginalData:!1,onUpload:function(){return!0},onUploadError:function(){return!0},onCropper:function(){return!0}},l=m.extend({},t,o);l.cropper=m.extend({},t.cropper,o.cropper),l.uploadConfig=m.extend({},t.uploadConfig,o.uploadConfig);var d=m("<img />").attr("id",l.imgId).css("max-width","100%"),e=void 0;if(l.body=m('<div class="img-container" />').append(d),l.onOpen=function(){e=new Cropper(d.get(0),l.cropper)},l.onOk=function(){var o=e.getCroppedCanvas().toDataURL();e.destroy(),function(o,l,d){if(void 0===l.width&&void 0===l.height&&d)return d(o);var c="",p=document.createElement("canvas"),s=p.getContext("2d"),f=new Image;f.src=o,f.onload=function(){var o,t,e,n,a=f.width,r=f.height,i=(o=a,t=r,e=l.width,n=l.height,Math.min(e/o,n/t));p.width=a*i,p.height=r*i,s.drawImage(f,0,0,a,r,0,0,a*i,r*i),c=p.toDataURL(),d&&d(c)}}(o,{width:l.maxWidth,height:l.maxHeight},function(o){if(l.onCropper.call(i,o,a(o)),"string"==typeof l.action){var t=a(o),e=new FormData;e.append(l.fileName,t);var n=Object.keys(l.data);n.length&&n.forEach(function(o){e.append(o,l.data[o])}),function(t,o){if(t.axios)t.axios({url:t.action,method:t.method,data:o,headers:{"Content-Type":"multipart/form-data"}}).then(function(o){t.success(t.axiosOriginalData?o:o.data)}).catch(t.error);else{if(void 0===m.ajax)throw"Error: ajax function is not found, Can't upload image.";m.ajax(t.action,{method:t.method,data:o,processData:!1,contentType:!1,success:t.success,error:t.error})}}(l,e)}})},l.onCancel=function(){e.destroy()},l.src)d.attr("src",l.src),this.bsModal(l);else{var c=this.children("input[type=file]").get(0);c.onchange=function(){if(c.files.length){var t=c.files[0];if(!1!==l.onUpload.call(i)){var o,e,n;if(l.uploadConfig.allowTypes)if(!l.uploadConfig.allowTypes.some(function(o){return o===t.type}))return void l.onUploadError.call(i,"Upload file type is wrong");if(l.uploadConfig.maxSize){var a=l.uploadConfig.maxSize;if(t.size>a){var r=void 0;return a<1024?r=a+" B":a>=Math.pow(1024,1)&&a<Math.pow(1024,2)?r=Math.floor(a/Math.pow(1024,1))+" KB":a>=Math.pow(1024,2)&&a<Math.pow(1024,3)&&(r=Math.floor(a/Math.pow(1024,2))+" MB"),void l.onUploadError.call(i,"Uploaded file cannot be larger than "+r)}}o=t,e=function(o){l.src=o,d.attr("src",l.src),i.bsModal(l),i.modal.modal("show"),i.removeAttr("data-toggle").removeAttr("data-target")},(n=new FileReader).onload=function(o){e(o.target.result)},n.readAsDataURL(o)}}}}return this}});